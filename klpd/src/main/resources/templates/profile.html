<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" th:replace="userdashboard::layout(~{::main})">

<head>

</head>

<body class="text-light" style="background-color: #121212;">

    <!-- Main Content -->
     <main>
        
        <div class="p-4 px-5 border rounded" style="background-color: #1f1f1f;">
            <!-- Form with th:action for submitting to the update profile endpoint -->
            <form id="personalInfoForm" th:action="@{/profile/update}" method="post">
                <div class="d-flex justify-content-between">
                    <h4>Personal Information</h4>
                    <button type="button" class="btn btn-primary" id="editButton">Edit</button>
                </div>
                <div class="mt-4 mb-5">
                    <div class="row">
                        <label for="firstName" class="form-label">First Name</label>
                        <div class="col-md-4">
                            <input type="text" class="form-control bg-dark text-light" 
                                th:value="${user.name.split(' ')[0]}" id="firstName" name="firstName" placeholder="First name" aria-label="First name" readonly>
                        </div>
                        <div class="col-md-4">
                            <input type="text" class="form-control bg-dark text-light" 
                                th:value="${user.name.split(' ').length > 1 ? user.name.split(' ')[1] : ''}" id="middleName" name="middleName" placeholder="Middle name" aria-label="Middle name" readonly>
                        </div>
                        <div class="col-md-4">
                            <input type="text" class="form-control bg-dark text-light" 
                                th:value="${user.name.split(' ').length > 2 ? user.name.split(' ')[2] : ''}" id="lastName" name="lastName" placeholder="Last name" aria-label="Last name" readonly>
                        </div>
                    </div>
                </div>
                <div class="mb-5">
                    <label for="gender" class="form-label">Gender</label>
                    <div>
                        <div class="form-check form-check-inline">
                            <input class="form-check-input" type="radio" name="gender" id="male" value="Male" 
                                th:checked="${user.gender == 'Male'}" disabled>
                            <label class="form-check-label" for="male">Male</label>
                        </div>
                        <div class="form-check form-check-inline">
                            <input class="form-check-input" type="radio" name="gender" id="female" value="Female" 
                                th:checked="${user.gender == 'Female'}" disabled>
                            <label class="form-check-label" for="female">Female</label>
                        </div>
                        <div class="form-check form-check-inline">
                            <input class="form-check-input" type="radio" name="gender" id="others" value="Others" 
                                th:checked="${user.gender == 'Others'}" disabled>
                            <label class="form-check-label" for="others">Others</label>
                        </div>
                    </div>
                </div>
                <div class="mb-5">
                    <label for="email" class="form-label">Email Address</label>
                    <div>
                        <input type="email" class="form-control bg-dark text-light" 
                            th:value="${user.email}" id="email" name="email" placeholder="E-mail Address" readonly>
                    </div>
                </div>
                <div class="mb-5">
                    <label for="dob" class="form-label">Date of Birth</label>
                    <input type="date" class="form-control bg-dark text-light" 
                        th:value="${user.dob}" id="dob" name="dob" required>
                </div>
                <div class="mb-5">
                    <label for="contactNumber" class="form-label">Contact Number</label>
                    <div>
                        <input type="text" class="form-control bg-dark text-light" 
                            th:value="${user.mobile}" id="contactNumber" name="contactNumber" placeholder="Contact number" readonly>
                    </div>
                </div>
            </form>

            <div class="mb-2">
                <button type="submit" class="btn btn-primary me-2" form="personalInfoForm">Deactivate Account</button>
                <button type="submit" class="btn btn-danger" form="personalInfoForm">Delete Account</button>
            </div>
        </div>
    </main>
    <script>
        const editButton = document.getElementById("editButton");
        const formFields = document.querySelectorAll("#personalInfoForm input, #personalInfoForm input[type='radio']");

        editButton.addEventListener("click", () => {
            const isEditing = editButton.textContent === "Edit";

            // Toggle text of the button
            editButton.textContent = isEditing ? "Save" : "Edit";

            // Toggle read-only state for all input fields
            formFields.forEach((field) => {
                field.readOnly = !isEditing; // Enable/Disable text fields
                field.disabled = !isEditing; // Enable/Disable radio buttons
            });
        });
    </script>
</body>

</html>