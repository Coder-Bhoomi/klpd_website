<!doctype html>
<html lang="en" th:replace="base::layout(~{::main})">

<head>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://kit.fontawesome.com/a076d05399.js" crossorigin="anonymous"></script>

</head>

<body>
    <main>

        <div class="container cart-container">
            <h3 class="mb-5 text-center fw-bold">Your Cart</h3>
            <div class="row g-4">
                <!-- Left: Cart Items -->
                <div class="col-md-8">
                    <!-- Product Item -->
                    <div class="card-dark d-flex justify-content-between align-items-center mb-3">
                        <div class="d-flex gap-3 align-items-center">
                            <img src="/images/utensils.jpg" class="product-img" alt="Product">
                            <div>
                                <h5>Zim Baby Bedding Set ( Green )</h5>
                                <div class="mb-1">
                                    <span class="fw-bold">‚Çπ499.00</span>
                                    <span class="price-original">‚Çπ792.00</span>
                                </div>
                                <div class="discount">You save ‚Çπ293.00 (37%)</div>
                                <div class="mt-2 quantity-box">
                                    <i class="fas fa-minus"></i>
                                    <span>1</span>
                                    <i class="fas fa-plus"></i>
                                </div>
                            </div>
                        </div>
                        <div class="btn-remove"><i class="fas fa-trash-alt"> </i>  Remove</div>
                    </div>

                    <!-- You can duplicate the above block for more products -->
                </div>

                <!-- Right: Summary -->
                <div class="col-md-4">
                    <div class="summary-card">
                        <!-- Coupon Section -->
                        <div class="mb-3">
                            <label for="coupon" class="form-label">Have a Coupon Code?</label>
                            <div class="input-group">
                                <input type="text" id="coupon" class="form-control bg-dark text-white border-secondary"
                                    placeholder="Enter coupon code">
                                <button class="btn btn-outline-warning" onclick="applyCoupon()">Apply</button>
                            </div>
                            <small id="coupon-msg" class="text-success mt-1 d-block" style="display: none;">üéâ Coupon
                                applied successfully!</small>
                        </div>

                        <h5 class="mb-3">Price Summary</h5>
                        <ul class="list-group summary-list">
                            <li class="d-flex justify-content-between">
                                <span>Subtotal</span>
                                <span>‚Çπ792.00</span>
                            </li>
                            <li class="d-flex justify-content-between">
                                <span>Discount</span>
                                <span class="text-success">-‚Çπ293.00</span>
                            </li>
                            <li class="d-flex justify-content-between">
                                <span>Shipping</span>
                                <span class="text-success">FREE</span>
                            </li>
                            <li class="d-flex justify-content-between total-amount mt-3">
                                <span>Total</span>
                                <span>‚Çπ499.00</span>
                            </li>
                        </ul>
                        <p class="mt-2 text-secondary" style="font-size: 0.85rem;">(inclusive of all taxes)</p>

                        <button class="btn btn-checkout mt-3">Continue to Checkout</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Cart Container -->
        <!-- <div class="container cart-container">
            <h2 class="text-center mb-4 fw-bold mt-3">Shopping Cart</h2> -->

        <!-- Cart Items -->
        <!-- <div id="cart-items">
                 Render Cart Items Dynamically 
                <div class="cart-item d-flex align-items-center" th:each="cartItem : ${cart}">

                    <div class="col-2">
                        <img th:src="@{${cartItem.product.images[0].imageUrl}}" alt="Product Image"
                            class="img-fluid rounded">
                    </div>
                    <div class="col-4">
                        <p class="mb-1 mx-5" th:text="${cartItem.product.prodName}">Product Name</p>
                    </div>
                    <div class="col-1">
                        <form th:action="@{/cart/update}" method="post">
                            <input type="hidden" th:value="${cartItem.cartId}" name="cartId">
                            <input type="number" class="form-control quantity-input" style="width: 60px;" min="1"
                                th:value="${cartItem.quantity}" name="quantity" onchange="this.form.submit()">
                        </form>
                    </div>
                    <div class="col-3 text-success fw-bold item-price text-center mx-4"
                        th:text="${cartItem.productTotal}">Price</div>
                    <div class="col-1 text-end">
                        <a th:href="@{cart/delete(id=${cartItem.cartId})}">
                            <button class="btn btn-outline-danger btn-sm">Delete</button>
                        </a>
                    </div>
                </div>
            </div>

             Coupon Section 
            <div class="coupon-section mt-4">
                <h5 class="fw-bold mx-1">Coupon</h5>
                <form class="input-group" th:action="@{/cart/apply-coupon}" method="post">
                    <input type="text" class="form-control bg-dark text-light" name="couponCode" placeholder="Coupon Code">
                    <button type="submit" class="btn btn-primary">Apply</button>
                </form>
            </div>

             Summary Section 
            <div class="summary-section mt-4">
                <h5 class="fw-bold">Order Summary</h5>
                <div class="d-flex justify-content-between">
                    <p>Subtotal</p>
                    <p id="subtotal-price" class="fw-bold" th:text="${subtotal}">$0.00</p>
                </div>
                <div class="d-flex justify-content-between">
                    <p>Discount</p>
                    <p id="discount-price" class="fw-bold" th:text="${discount}">$0.00</p>
                </div>
                <div class="d-flex justify-content-between">
                    <p>Tax (2%)</p>
                    <p id="tax-price" class="fw-bold" th:text="${tax}">$0.00</p>
                </div>
                <hr>
                <div class="d-flex justify-content-between">
                    <h5>Total</h5>
                    <h5 id="total-price" class="fw-bold" th:text="${total}">$0.00</h5>
                </div>
            </div>

             Action Buttons 
            <div class="action-buttons mt-4">
                <form th:action="@{/cart/checkout}" method="post">
                    <button type="submit" class="btn checkoutbutton d-block mx-auto p-2 w-100 mb-2"
                        style="background-color: #367D8A; color: #ffff; font-size: 16px;"><span>Checkout</span></button>
                </form>
                <a href="/" class="btn btn-outline-secondary d-block mx-auto p-2 w-100">Continue Shopping</a>
            </div>
        </div> -->
    </main>
    <script>
        function updateCart(element, cartId) {
            const quantity = element.value;
            fetch(`/cart/update?cartId=${cartId}&quantity=${quantity}`, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                }
            }).then(response => {
                if (response.ok) {
                    window.location.reload();  // Reload page after updating the cart
                }
            });
        }


        function applyCoupon() {
            const input = document.getElementById("coupon").value.trim();
            const msg = document.getElementById("coupon-msg");

            if (input.toUpperCase() === "SAVE100") {
                msg.style.display = "block";
                msg.textContent = "üéâ Coupon applied successfully!";
                // You can update pricing here dynamically
            } else {
                msg.style.display = "block";
                msg.textContent = "‚ùå Invalid coupon code!";
                msg.classList.remove("text-success");
                msg.classList.add("text-danger");
            }
        }


    </script>
</body>

</html>