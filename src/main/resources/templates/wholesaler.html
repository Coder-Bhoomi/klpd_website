<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <!-- Bootstrap CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <!-- Font Awesome -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <link rel="icon" type="image/x-icon" href="/images/logo2.jpg">
    <title>Homes and Pans</title>
    <link rel="stylesheet" href="/css/registration.css">


  <style>  
    
    .password-toggle {
      cursor: pointer;
    }
    
    .input-icon {
      position: absolute;
      right: 15px;
      top: 50%;
      transform: translateY(-50%);
      color: #6c757d;
    }
  </style>
</head>

<body>
  <div class="container-fluid">
    <div class="row justify-content-center">
      <div class="col-lg-8">
        <div class="card shadow-lg">
          <div class="card-body p-4 p-md-5">
            <a href="/" class="btn btn-primary"><i class="fas fa-home"></i> Return to Home</a>
            <!-- Registration Form -->
            <form id="registrationForm" class="form-container" th:action="@{/registerwholesale}" th:object="${dto}" method="post">
              <div class="text-center mb-4">
                <h2 class="text-dark"><i class="fas fa-user-plus"></i> Create Account</h2>
                <p class="text-muted">Register your wholesale business to get started</p>
              </div>
              
              <div class="row g-3">
                <div class="col-md-6 position-relative">
                  <div class="form-floating mb-3">
                    <input type="text" th:field="${dto.name}" class="form-control" id="name" name="name" placeholder="Name" required>
                    <label for="name">Full Name</label>
                    <i class="fas fa-user input-icon"></i>
                    <div class="invalid-feedback" id="nameError"></div>
                  </div>
                </div>
                
                <div class="col-md-6 position-relative">
                  <div class="form-floating mb-3">
                    <input type="text" th:field="${dto.companyName}" class="form-control" id="orgName" name="orgName" placeholder="Organization Name" required>
                    <label for="orgName">Organization Name</label>
                    <i class="fas fa-building input-icon"></i>
                    <div class="invalid-feedback" id="orgNameError"></div>
                  </div>
                </div>
                
                <div class="col-md-6 position-relative">
                  <div class="form-floating mb-3">
                    <input type="text" th:field="${dto.gSTIN}" class="form-control" id="gstin" name="gstin" placeholder="22AAAAA0000A1Z5" required>
                    <label for="gstin">GSTIN Number <small class="text-muted">15 characters</small></label>
                    <i class="fas fa-id-card input-icon"></i>
                    <div class="invalid-feedback" id="gstinError"></div>
                  </div>
                </div>
                
                <div class="col-md-6 position-relative">
                  <div class="form-floating mb-3">
                    <input type="tel" th:field="${dto.contactNumber}" class="form-control" id="contactNumber" name="contactNumber" placeholder="Phone" required>
                    <label for="contactNumber">Contact Number</label>
                    <i class="fas fa-phone input-icon"></i>
                    <div class="invalid-feedback" id="contactNumberError"></div>
                  </div>
                </div>
                
                <div class="col-md-6 position-relative">
                  <div class="form-floating mb-3">
                    <input type="text" th:field="${dto.officeAddress}" class="form-control" id="officialAddress" name="officialAddress" placeholder="Address" required>
                    <label for="officialAddress">Official Address</label>
                    <i class="fas fa-map-marker-alt input-icon"></i>
                    <div class="invalid-feedback" id="officialAddressError"></div>
                  </div>
                </div>
                
                <div class="col-md-6 position-relative">
                  <div class="form-floating mb-3">
                    <input type="text" th:field="${dto.shippingAddress}" class="form-control" id="shippingAddress" name="shippingAddress" placeholder="Address" required>
                    <label for="shippingAddress">Shipping Address</label>
                    <i class="fas fa-truck input-icon"></i>
                    <div class="invalid-feedback" id="shippingAddressError"></div>
                  </div>
                </div>
                
                <div class="col-md-6 position-relative">
                  <div class="form-floating mb-3">
                    <input type="email" th:field="${dto.email}" class="form-control" id="email" name="email" placeholder="Email" required>
                    <label for="email">Email Address</label>
                    <i class="fas fa-envelope input-icon"></i>
                    <div class="invalid-feedback" id="emailError"></div>
                  </div>
                </div>
                
                <div class="col-md-6 position-relative">
                  <div class="form-floating mb-3">
                    <input type="text" th:field="${dto.organisationNumber}" class="form-control" id="orgNumber" name="orgNumber" placeholder="Org Number" required>
                    <label for="orgNumber">Organization Number</label>
                    <i class="fas fa-hashtag input-icon"></i>
                    <div class="invalid-feedback" id="orgNumberError"></div>
                  </div>
                </div>
                
                <div class="col-md-6 position-relative">
                  <div class="form-floating mb-3">
                    <input type="password" th:field="${dto.password}" class="form-control" id="password" name="password" placeholder="Password" required>
                    <label for="password">Password</label>
                    <i class="fas fa-eye password-toggle position-absolute end-0 me-3"></i>
                    <div class="invalid-feedback" id="passwordError"></div>
                  </div>
                </div>
                
                <div class="col-md-6 position-relative">
                  <div class="form-floating mb-3">
                    <input type="password" class="form-control" id="confirmPassword" name="confirmPassword" placeholder="Confirm Password" required>
                    <label for="confirmPassword">Confirm Password</label>
                    <i class="fas fa-eye password-toggle position-absolute end-0 me-3"></i>
                    <div class="invalid-feedback" id="confirmPasswordError"></div>
                  </div>
                </div>
              </div>
              
              <button type="submit" class="btn btn-primary w-100 py-2 mb-3">
                <i class="fas fa-user-plus me-2"></i> Register Account
              </button>
              
              <div class="text-center text-muted">
                <i class="fas fa-sign-in-alt me-2"></i>Already have an account? <a href="#" class="text-decoration-none" id="showLogin">Sign In</a>
              </div>
            </form>

            <!-- Login Form -->
            <form id="loginForm" class="form-container d-none" th:action="@{/submit}" method="post">
              <div class="text-center mb-4">
                <i class="fas fa-sign-in-alt text-primary mb-3 fs-1"></i>
                <h2 class="text-dark">Welcome Back</h2>
                <p class="text-muted">Sign in to your wholesale account</p>
              </div>
              
              <div class="form-floating mb-3 position-relative">
                <input type="email" class="form-control" id="loginEmail" name="email" placeholder="Email" required>
                <label for="loginEmail">Email Address</label>
                <i class="fas fa-envelope input-icon"></i>
                <div class="invalid-feedback" id="loginEmailError"></div>
              </div>
              
              <div class="form-floating mb-3 position-relative">
                <input type="password" class="form-control" id="loginPassword" name="password" placeholder="Password" required>
                <label for="loginPassword">Password</label>
                <i class="fas fa-eye password-toggle position-absolute end-0 me-3"></i>
                <div class="invalid-feedback" id="loginPasswordError"></div>
              </div>
              
              <button type="submit" class="btn btn-primary w-100 py-2 mb-3">
                <i class="fas fa-sign-in-alt me-2"></i> Sign In
              </button>
              
              <div class="text-center text-muted">
                <i class="fas fa-user-plus me-2"></i>Don't have an account? <a href="#" class="text-decoration-none" id="showRegister">Create Account</a>
              </div>
            </form>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Bootstrap JS -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
  <script>
    // DOM Elements
    const registrationForm = document.getElementById('registrationForm');
    const loginForm = document.getElementById('loginForm');
    const showLogin = document.getElementById('showLogin');
    const showRegister = document.getElementById('showRegister');
    const passwordToggles = document.querySelectorAll('.password-toggle');
    const passwordInput = document.getElementById('password');
    const confirmPasswordInput = document.getElementById('confirmPassword');
    const loginPasswordInput = document.getElementById('loginPassword');
    const toastContainer = document.createElement('div');
    toastContainer.className = 'position-fixed top-0 end-0 p-3';
    toastContainer.style.zIndex = '1100';
    document.body.appendChild(toastContainer);

    // Toggle between Login and Registration forms
    showLogin.addEventListener('click', (e) => {
      e.preventDefault();
      registrationForm.classList.add('d-none');
      loginForm.classList.remove('d-none');
    });

    showRegister.addEventListener('click', (e) => {
      e.preventDefault();
      loginForm.classList.add('d-none');
      registrationForm.classList.remove('d-none');
    });

    // Password visibility toggle
    passwordToggles.forEach(toggle => {
      toggle.addEventListener('click', function() {
        const input = this.parentElement.querySelector('input');
        const type = input.getAttribute('type') === 'password' ? 'text' : 'password';
        input.setAttribute('type', type);
        this.classList.toggle('fa-eye-slash');
      });
    });

    // Confirm password validation
    confirmPasswordInput.addEventListener('input', validatePasswordMatch);

    function validatePasswordMatch() {
      if (passwordInput.value !== confirmPasswordInput.value) {
        confirmPasswordInput.classList.add('is-invalid');
        document.getElementById('confirmPasswordError').textContent = 'Passwords do not match';
        return false;
      } else {
        confirmPasswordInput.classList.remove('is-invalid');
        document.getElementById('confirmPasswordError').textContent = '';
        return true;
      }
    }

    // Show toast notification using Bootstrap
    function showToast(message, type = 'success') {
      const toastEl = document.createElement('div');
      toastEl.className = `toast show align-items-center text-white bg-${type} border-0`;
      toastEl.setAttribute('role', 'alert');
      toastEl.setAttribute('aria-live', 'assertive');
      toastEl.setAttribute('aria-atomic', 'true');
      
      toastEl.innerHTML = `
        <div class="d-flex">
          <div class="toast-body">
            <i class="fas ${type === 'success' ? 'fa-check-circle' : 'fa-exclamation-circle'} me-2"></i>
            ${message}
          </div>
          <button type="button" class="btn-close btn-close-white me-2 m-auto" data-bs-dismiss="toast" aria-label="Close"></button>
        </div>
      `;
      
      toastContainer.appendChild(toastEl);
      
      // Remove toast after delay
      setTimeout(() => {
        toastEl.classList.remove('show');
        setTimeout(() => toastEl.remove(), 300);
      }, 3000);
    }

    // Validation for Registration Form
    registrationForm.addEventListener('submit', function(e) {
      e.preventDefault();
      let isValid = true;

      // Reset validation
      this.querySelectorAll('.is-invalid').forEach(el => el.classList.remove('is-invalid'));

      // Name validation
      const name = document.getElementById('name').value.trim();
      if (name === '') {
        document.getElementById('name').classList.add('is-invalid');
        document.getElementById('nameError').textContent = 'Name is required';
        isValid = false;
      } else if (name.length < 2) {
        document.getElementById('name').classList.add('is-invalid');
        document.getElementById('nameError').textContent = 'Name is too short';
        isValid = false;
      }

      // Organization Name validation
      const orgName = document.getElementById('orgName').value.trim();
      if (orgName === '') {
        document.getElementById('orgName').classList.add('is-invalid');
        document.getElementById('orgNameError').textContent = 'Organization Name is required';
        isValid = false;
      }

      // GSTIN validation
      const gstin = document.getElementById('gstin').value.trim();
      if (gstin.length !== 15) {
        document.getElementById('gstin').classList.add('is-invalid');
        document.getElementById('gstinError').textContent = 'GSTIN must be 15 characters';
        isValid = false;
      } else if (!/^[0-9]{2}[A-Z]{5}[0-9]{4}[A-Z]{1}[1-9A-Z]{1}Z[0-9A-Z]{1}$/.test(gstin)) {
        document.getElementById('gstin').classList.add('is-invalid');
        document.getElementById('gstinError').textContent = 'Invalid GSTIN format';
        isValid = false;
      }

      // Contact Number validation
      const contactNumber = document.getElementById('contactNumber').value.trim();
      if (!/^\d{10}$/.test(contactNumber)) {
        document.getElementById('contactNumber').classList.add('is-invalid');
        document.getElementById('contactNumberError').textContent = 'Contact Number must be 10 digits';
        isValid = false;
      }

      // Email validation
      const email = document.getElementById('email').value.trim();
      if (!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(email)) {
        document.getElementById('email').classList.add('is-invalid');
        document.getElementById('emailError').textContent = 'Invalid Email Address';
        isValid = false;
      }

      // Password validation
      const password = document.getElementById('password').value.trim();
      if (password.length < 8) {
        document.getElementById('password').classList.add('is-invalid');
        document.getElementById('passwordError').textContent = 'Password must be at least 8 characters';
        isValid = false;
      } else if (password.length > 0 && document.getElementById('passwordStrength').style.width === '25%') {
        document.getElementById('password').classList.add('is-invalid');
        document.getElementById('passwordError').textContent = 'Password is too weak';
        isValid = false;
      }

      // Confirm Password validation
      if (!validatePasswordMatch()) {
        isValid = false;
      }

      if (isValid) {
        showToast('Registration successful! Redirecting...', 'success');
        // In a real app, you would submit the form here
        // registrationForm.submit();
        setTimeout(() => {
          registrationForm.submit();
        }, 1500);
      } else {
        showToast('Please fix the errors in the form', 'danger');
      }
    });

    // Validation for Login Form
    loginForm.addEventListener('submit', function(e) {
      e.preventDefault();
      let isValid = true;

      // Reset validation
      this.querySelectorAll('.is-invalid').forEach(el => el.classList.remove('is-invalid'));

      // Email validation
      const loginEmail = document.getElementById('loginEmail').value.trim();
      if (!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(loginEmail)) {
        document.getElementById('loginEmail').classList.add('is-invalid');
        document.getElementById('loginEmailError').textContent = 'Invalid Email Address';
        isValid = false;
      }

      // Password validation
      const loginPassword = document.getElementById('loginPassword').value.trim();
      if (loginPassword.length < 8) {
        document.getElementById('loginPassword').classList.add('is-invalid');
        document.getElementById('loginPasswordError').textContent = 'Password must be at least 8 characters';
        isValid = false;
      }

      if (isValid) {
        showToast('Login successful! Redirecting...', 'success');
        // loginForm.submit();
        setTimeout(() => {
          loginForm.submit();
        }, 1500);
      } else {
        showToast('Please check your credentials', 'danger');
      }
    });

    // Input validation on blur
    document.querySelectorAll('input').forEach(input => {
      input.addEventListener('blur', function() {
        if (this.id === 'name' && this.value.trim().length < 2 && this.value.trim() !== '') {
          this.classList.add('is-invalid');
          document.getElementById('nameError').textContent = 'Name is too short';
        }
        
        if (this.id === 'gstin' && this.value.trim().length !== 15 && this.value.trim() !== '') {
          this.classList.add('is-invalid');
          document.getElementById('gstinError').textContent = 'GSTIN must be 15 characters';
        }
        
        if (this.id === 'contactNumber' && !/^\d{10}$/.test(this.value.trim()) && this.value.trim() !== '') {
          this.classList.add('is-invalid');
          document.getElementById('contactNumberError').textContent = 'Must be 10 digits';
        }
        
        if (this.id === 'email' && !/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(this.value.trim()) && this.value.trim() !== '') {
          this.classList.add('is-invalid');
          document.getElementById('emailError').textContent = 'Invalid email format';
        }
      });
      
      // Remove invalid class when user starts typing
      input.addEventListener('input', function() {
        if (this.classList.contains('is-invalid')) {
          this.classList.remove('is-invalid');
        }
      });
    });
  </script>
</body>

</html>